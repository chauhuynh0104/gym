<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L·ªãch T·∫≠p 6 Bu·ªïi</title>
<style>
    body {font-family: Arial, sans-serif; background:#f7f8fa; color:#333; margin:0; padding:0;}
    header {text-align:center; background:#007BFF; color:white; padding:15px; font-size:1.4em; font-weight:bold;top:0; box-shadow:0 2px 5px rgba(0,0,0,0.15);}
    .fade-in {animation: fadeIn 0.4s ease forwards;}
    @keyframes fadeIn {from {opacity:0; transform:translateY(15px);} to {opacity:1; transform:translateY(0);}}
    .menu, .workout {max-width:600px; margin:0 auto; padding:15px;}
    /* ======= MENU BUTTONS (NEW STYLE) ======= */
    .menu-btn {
        width:100%; padding:15px; margin:10px 0;
        border:2px solid #007BFF; border-radius:12px;
        background:#fff; color:#007BFF; font-size:1.1em; font-weight:bold;
        cursor:pointer; transition: all 0.25s ease;
        box-shadow:0 2px 4px rgba(0,0,0,0.05);
    }
    .menu-btn:hover {background:#f0f7ff;}
    .menu-btn:active {transform:scale(0.98); background:#e5f2ff;}
    .back-btn, .reset-btn, .reset-workout-btn {
        width:100%; padding:15px; margin:8px 0; border:none; border-radius:8px;
        font-size:1.05em; cursor:pointer; color:white;
        box-shadow:0 2px 5px rgba(0,0,0,0.2); transition: all 0.2s ease;
    }
    .back-btn {background:#6c757d;} .back-btn:active{transform:scale(0.98);}
    .reset-btn {background:#dc3545;} .reset-btn:active{transform:scale(0.98);}
    .reset-workout-btn {background:#fd7e14;} .reset-workout-btn:active{transform:scale(0.98);}
    
    .exercise {background:white; padding:12px; margin:12px 0; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); position: relative;}
.exercise strong {
    display: inline-block;
    margin-bottom: 8px;
    font-size: 1.05em;
}
    .set {margin:6px 0; display:flex; justify-content:space-between; align-items:center;}
    .set button {
        background:#28a745; color:white; border:none; border-radius:5px; padding:6px 10px; font-size:0.9em;
        box-shadow:0 2px 3px rgba(0,0,0,0.2); transition: transform 0.1s ease;
    }
    .set button:active {transform:scale(0.95);}
    .set button:disabled {background:#ccc; color:#666;}
    .locked button {background:#999; color:#fff; cursor:not-allowed;}
    .highlight {background:#ffc107 !important; color:#000 !important;}
    .rest-timer {color:#f44336; font-weight:bold;}
    .time-input {width:60px; text-align:center; border-radius:5px; border:1px solid #ccc; padding:3px; margin-left:5px;}
    .completed {text-decoration:line-through; opacity:0.6;}
    .progress-container {background:#ddd; border-radius:8px; height:20px; margin:15px 0; overflow:hidden;}
    .progress-bar {height:100%; width:0%; background:#28a745; text-align:center; color:white; font-size:0.8em; line-height:20px; transition:width 0.3s ease;}
    .gym-date-box {background:#fff; padding:10px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.05); margin-bottom:15px; font-size:0.95em;}
    .gym-date-box input {width:100%; padding:8px; border:1px solid #ccc; border-radius:5px; margin-top:5px;}



.exercise-header {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
}
.exercise-title {
    flex-grow: 1;
    font-size: 1.05em;
}
.exercise-actions {
    display: flex;
    gap: 5px;
}   .exercise-actions button {
        background: none; border: none; cursor: pointer; font-size: 0.9em;
        margin-left: 5px; color: #6c757d; padding: 2px 5px;
    }
    .exercise-actions button:hover {color: #007BFF;}
    .add-exercise {margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px;}
    .add-exercise input {width: calc(100% - 90px); padding: 8px; border: 1px solid #ccc; border-radius: 5px;}
    .add-exercise button {width: 80px; padding: 8px; margin-left: 10px; background: #007BFF; color: white; border: none; border-radius: 5px;}
footer {
    text-align: center;
    padding: 15px;
    background: linear-gradient(135deg, #343a40 0%, #23272b 100%);
    color: white;
    font-size: 0.9em;
    margin-top: auto;
}
</style>
</head>
<body>

<header>L·ªãch T·∫≠p 6 Bu·ªïi</header>

<div class="menu fade-in" id="menu">
    <div class="gym-date-box" id="gym-date-box"></div>
    <h2>Ch·ªçn nh√≥m c∆° h√¥m nay</h2>
    <button class="menu-btn" onclick="showWorkout('chestA')">üí™ Th·ª© 2 - Ng·ª±c (Chest A)</button>
    <button class="menu-btn" onclick="showWorkout('backA')">üèãÔ∏è Th·ª© 3 - L∆∞ng (Back A)</button>
    <button class="menu-btn" onclick="showWorkout('shoulder')">üèê Th·ª© 4 - Vai + C·∫ßu vai</button>
    <button class="menu-btn" onclick="showWorkout('backB')">üèãÔ∏è Th·ª© 5 - L∆∞ng (Back B)</button>
    <button class="menu-btn" onclick="showWorkout('chestB')">üí™ Th·ª© 6 - Ng·ª±c (Chest B)</button>
    <button class="menu-btn" onclick="showWorkout('backC')">üèãÔ∏è Th·ª© 7 - L∆∞ng (Back C)</button>
    <button class="reset-btn" onclick="resetProgress()">üîÑ Reset to√†n b·ªô ti·∫øn tr√¨nh</button>
</div>

<div class="workout fade-in" id="workout" style="display:none;"></div>
<footer>Design by Dr.Ch√¢u</footer>
<script>
// ==================== DATA ====================
// Load data from localStorage or use default
let data = JSON.parse(localStorage.getItem('workoutData')) || {
    chestA: ["Incline Smith Bench Press ‚Äì 4 sets √ó 6-10 reps","Iso-Lateral Chest Press (Incline Angle) ‚Äì 3 sets √ó 10-12 reps","Flat Bench Press Machine ‚Äì 3 sets √ó 10-12 reps","Cable Crossover (High to Low) ‚Äì 3 sets √ó 12-15 reps","Fly Chest Machine ‚Äì 3 sets √ó 12-15 reps"],
    backA: ["Pull-up ‚Äì 4 sets √ó max","Lat Pulldown Machine (wide grip) ‚Äì 3 sets √ó 10-12 reps","Iso-Lateral Pulldown ‚Äì 3 sets √ó 8-10 reps","Seated Cable Row Machine (neutral grip) ‚Äì 3 sets √ó 10-12 reps","Cable Straight Arm Pulldown ‚Äì 3 sets √ó 12-15 reps"],
    shoulder: ["Shoulder Press Smith Machine ‚Äì 4 sets √ó 6-10 reps","Shoulder Press Machine ‚Äì 3 sets √ó 10-12 reps","Dumbbell Lateral Raise ‚Äì 3 sets √ó 12-15 reps","Rear Delt on Fly Machine ‚Äì 3 sets √ó 12-15 reps","Dumbbell Shrugs ‚Äì 3 sets √ó 12-15 reps"],
    backB: ["Pull-up (n·∫Øm ng·ª≠a) ‚Äì 3 sets √ó max","Iso-Lateral Row ‚Äì 3 sets √ó 8-10 reps","Seated Cable Row (wide grip ho·∫∑c V-bar) ‚Äì 3 sets √ó 10-12 reps","Cable Shrug ‚Äì 3 sets √ó 15 reps"],
    chestB: ["Flat Barbell Bench Press ‚Äì 4 sets √ó 6-10 reps","Flat Bench Press Machine ‚Äì 3 sets √ó 10-12 reps","Iso-Lateral Chest Press (neutral/flat) ‚Äì 3 sets √ó 10-12 reps","Cable Crossover (Low to High) ‚Äì 3 sets √ó 12-15 reps","Fly Chest Machine ‚Äì 3 sets √ó 12-15 reps"],
    backC: ["Pull-up (r·ªông) ‚Äì 3 sets √ó max","Lat Pulldown Machine (reverse grip) ‚Äì 3 sets √ó 10 reps","Iso-Lateral Pulldown (t·ª´ng tay) ‚Äì 3 sets √ó 8 reps m·ªói b√™n","Seated Cable Row (drop set) ‚Äì 3 sets (10-10-10 reps, gi·∫£m t·∫°)","Dumbbell Shrug ho·∫∑c Cable Shrug ‚Äì 3 sets √ó 15 reps"]
};

function saveWorkoutData() {
    localStorage.setItem('workoutData', JSON.stringify(data));
}

let totalSets=0, completedSets=0, currentDay=null;

// ==================== GYM DATE ====================
function checkGymDate(){
    const box=document.getElementById('gym-date-box');
    let storedDate = localStorage.getItem("gymStartDate");
    if(storedDate){
        const startDate = new Date(storedDate);
        const nextMonth = new Date(startDate);
        nextMonth.setMonth(startDate.getMonth()+1);
        const today=new Date();
        if(today >= nextMonth){
            box.innerHTML=`<strong>ƒê·∫øn h·∫°n ƒë√≥ng ti·ªÅn!</strong><br>
                           <input type="date" id="gym-input" value="${today.toISOString().split('T')[0]}" onchange="saveGymDate()">`;
        }else{
            box.innerHTML=`‚úÖ ƒê√£ ƒë√≥ng t·ª´: <b>${startDate.toLocaleDateString('vi-VN')}</b><br>
                           H·∫°n ƒë√≥ng ti·∫øp: <b>${nextMonth.toLocaleDateString('vi-VN')}</b>`;
        }
    }else{
        box.innerHTML=`<strong>Nh·∫≠p ng√†y b·∫Øt ƒë·∫ßu ƒë√≥ng ti·ªÅn gym:</strong>
                       <input type="date" id="gym-input" onchange="saveGymDate()">`;
    }
}
function saveGymDate(){
    const val=document.getElementById('gym-input').value;
    if(val){localStorage.setItem("gymStartDate",val); checkGymDate();}
}

// ==================== WORKOUT ====================
function showWorkout(day){
    // Ki·ªÉm tra ng√†y m·ªõi v√† reset n·∫øu c·∫ßn
    checkAndResetDailyWorkout(day);
    
    document.getElementById('menu').style.display='none';
    const workout=document.getElementById('workout');
    workout.style.display='block';
    totalSets = completedSets = 0;
    currentDay = day;
    
    workout.innerHTML = `<button class="back-btn" onclick="backToMenu()">‚¨Ö Quay l·∫°i menu</button>
                         <button class="reset-workout-btn" onclick="resetCurrentWorkout()">üîÑ Reset b√†i t·∫≠p h√¥m nay</button>
                         <h2>B√†i t·∫≠p h√¥m nay</h2>
                         <div class="progress-container"><div class="progress-bar" id="progress-bar">0%</div></div>`;
    
    // Hi·ªÉn th·ªã c√°c b√†i t·∫≠p
    data[day].forEach((ex,i)=>{
        const sets = ex.match(/\d+\s*sets/)?.[0] || "3 sets";
        totalSets += parseInt(sets);
        const keyTime=`${day}-time-${i}`;
        const savedTime=localStorage.getItem(keyTime) || 120;
   workout.innerHTML += `<div class="exercise fade-in">
    <div class="exercise-header">
        <span class="exercise-title"><b>${i+1}. ${ex}</b></span>
        <div class="exercise-actions">
            <button onclick="editExercise('${day}', ${i})">‚úèÔ∏è</button>
            <button onclick="deleteExercise('${day}', ${i})">üóëÔ∏è</button>
        </div>
    </div>
    <label>Ngh·ªâ (s): <input type="number" class="time-input" value="${savedTime}" oninput="saveTime('${keyTime}',this.value)"></label>
    <div class="sets">${generateSets(day,i,sets)}</div>
</div>`;
    });
    
    // Th√™m n√∫t th√™m b√†i t·∫≠p
    workout.innerHTML += `<div class="add-exercise">
        <input type="text" id="new-exercise" placeholder="Th√™m b√†i t·∫≠p m·ªõi (VD: Dumbbell Press ‚Äì 3 sets √ó 10 reps)">
        <button onclick="addExercise('${day}')">Th√™m</button>
    </div>`;
    
    lockAllExceptFirst();
    updateProgress();
    
    setTimeout(() => checkActiveTimers(day), 500);
    
}

function editExercise(day, index) {
    const newExercise = prompt("S·ª≠a b√†i t·∫≠p:", data[day][index]);
    if (newExercise !== null) {
        data[day][index] = newExercise;
        saveWorkoutData();
        showWorkout(day);
    }
}

function deleteExercise(day, index) {
    if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a b√†i t·∫≠p n√†y?")) {
        data[day].splice(index, 1);
        saveWorkoutData();
        showWorkout(day);
    }
}

function addExercise(day) {
    const input = document.getElementById('new-exercise');
    if (input.value.trim()) {
        data[day].push(input.value.trim());
        saveWorkoutData();
        showWorkout(day);
    } else {
        alert("Vui l√≤ng nh·∫≠p t√™n b√†i t·∫≠p!");
    }
}

function checkAndResetDailyWorkout(day) {
    const today = new Date().toDateString();
    const lastWorkoutDay = localStorage.getItem('lastWorkoutDay');
    const lastWorkoutType = localStorage.getItem('lastWorkoutType');
    
    // N·∫øu l√† ng√†y m·ªõi ho·∫∑c b√†i t·∫≠p kh√°c, reset progress
    if (today !== lastWorkoutDay || day !== lastWorkoutType) {
        // X√≥a t·∫•t c·∫£ key li√™n quan ƒë·∫øn b√†i t·∫≠p n√†y
        Object.keys(localStorage).forEach(key => {
            if (key.startsWith(day + '-') && !key.includes('-time-')) {
                localStorage.removeItem(key);
            }
        });
        
        // L∆∞u l·∫°i ng√†y v√† lo·∫°i b√†i t·∫≠p hi·ªán t·∫°i
        localStorage.setItem('lastWorkoutDay', today);
        localStorage.setItem('lastWorkoutType', day);
    }
}

function resetCurrentWorkout() {
    if (!currentDay) return;
    if (confirm("B·∫°n c√≥ ch·∫Øc mu·ªën reset ti·∫øn tr√¨nh b√†i t·∫≠p h√¥m nay?")) {
        // X√≥a t·∫•t c·∫£ key li√™n quan ƒë·∫øn b√†i t·∫≠p hi·ªán t·∫°i
        Object.keys(localStorage).forEach(key => {
            if (key.startsWith(currentDay + '-') && !key.includes('-time-')) {
                localStorage.removeItem(key);
            }
        });
        // Load l·∫°i b√†i t·∫≠p
        showWorkout(currentDay);
    }
}

function saveTime(key,val){if(val>0) localStorage.setItem(key,val);}
function generateSets(day,exIndex,setText){
    const sets = parseInt(setText); let html = "";
    for(let i=1;i<=sets;i++){
        const key=`${day}-${exIndex}-${i}`;
        const done=localStorage.getItem(key)==="1" ? "completed" : "";
        if(done) completedSets++;
        html += `<div class="set ${done} ${!done && i!==1?"locked":""}">
            Set ${i}: <button onclick="startRest(this,'${key}')">${done?"ƒê√£ xong":"Ho√†n th√†nh"}</button>
            <span class="rest-timer">Ngh·ªâ: <span class="countdown">0</span>s</span>
        </div>`;
    }return html;
}
function lockAllExceptFirst(){
    document.querySelectorAll('.set.locked button').forEach(btn=>btn.disabled=true);
    const firstUnlocked=document.querySelector('.set:not(.completed):not(.locked) button');
    if(firstUnlocked) firstUnlocked.classList.add("highlight");
}
function startRest(btn, key) {
    if (btn.closest('.set').classList.contains("locked")) {
        alert("Ph·∫£i t·∫≠p theo th·ª© t·ª± t·ª´ tr√™n xu·ªëng!");
        return;
    }
    if (localStorage.getItem(key) === "1") {
        alert("Set n√†y ƒë√£ ho√†n th√†nh tr∆∞·ªõc ƒë√≥!");
        return;
    }

    const restTimer = btn.parentNode.querySelector('.rest-timer');
    const timeInput = btn.closest('.exercise').querySelector('.time-input');
    let totalTime = parseInt(timeInput.value) || 120;
    
    // L∆∞u th·ªùi gian k·∫øt th√∫c v√†o localStorage
    const endTime = Date.now() + totalTime * 1000;
    localStorage.setItem(key + "-timer", endTime.toString());
    
    btn.disabled = true;
    restTimer.style.display = "inline";
    
    // B·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c
    updateTimer(btn, key, restTimer, endTime);
}

function updateTimer(btn, key, restTimer, endTime) {
    const now = Date.now();
    const remaining = Math.max(0, Math.floor((endTime - now) / 1000));
    
    restTimer.querySelector('.countdown').textContent = remaining;
    
    if (remaining > 0) {
        // N·∫øu c√≤n th·ªùi gian, ti·∫øp t·ª•c ƒë·∫øm
        setTimeout(() => updateTimer(btn, key, restTimer, endTime), 1000);
    } else {
        // Khi h·∫øt gi·ªù
        restTimer.style.display = "none";
        btn.disabled = false;
        btn.textContent = "ƒê√£ xong";
        btn.parentNode.classList.add("completed");
        localStorage.setItem(key, "1");
        localStorage.removeItem(key + "-timer"); // X√≥a timer ƒë√£ ho√†n th√†nh
        completedSets++;
        updateProgress();
        playBeep();
        autoNext(btn);
    }
}

// Th√™m h√†m n√†y ƒë·ªÉ ki·ªÉm tra v√† ti·∫øp t·ª•c timer khi t·∫£i trang
function checkActiveTimers(day) {
    const exercises = document.querySelectorAll('.exercise');
    exercises.forEach((ex, exIndex) => {
        const sets = ex.querySelectorAll('.set');
        sets.forEach((set, setIndex) => {
            const key = `${day}-${exIndex}-${setIndex + 1}`;
            const timerEnd = localStorage.getItem(key + "-timer");
            
            if (timerEnd) {
                const endTime = parseInt(timerEnd);
                const now = Date.now();
                
                if (now < endTime) {
                    // Timer v·∫´n ƒëang ch·∫°y
                    const btn = set.querySelector('button');
                    const restTimer = set.querySelector('.rest-timer');
                    
                    btn.disabled = true;
                    restTimer.style.display = "inline";
                    updateTimer(btn, key, restTimer, endTime);
                } else {
                    // Timer ƒë√£ h·∫øt nh∆∞ng ch∆∞a ƒë∆∞·ª£c x·ª≠ l√Ω
                    localStorage.removeItem(key + "-timer");
                    localStorage.setItem(key, "1");
                }
            }
        });
    });
}
function updateProgress(){
    const percent = ((completedSets/totalSets)*100).toFixed(0);
    const bar=document.getElementById('progress-bar');
    if(bar){bar.style.width=percent+"%"; bar.textContent=percent+"%";}
}
function autoNext(btn){
    alert("T√≠t t√≠t! H·∫øt gi·ªù ngh·ªâ, t·ª± chuy·ªÉn sang set ti·∫øp theo!");
    const nextSet=btn.closest('.set').nextElementSibling;
    if(nextSet){
        nextSet.classList.remove("locked");
        const nbtn=nextSet.querySelector('button');
        nbtn.disabled=false; nbtn.classList.add("highlight");
        nbtn.scrollIntoView({behavior:"smooth",block:"center"});
    }
}
function playBeep(){
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    function beep(){
        const osc=ctx.createOscillator(),gain=ctx.createGain();
        osc.connect(gain); gain.connect(ctx.destination);
        osc.type="square"; osc.frequency.value=1000; gain.gain.setValueAtTime(0.2,ctx.currentTime);
        osc.start(); osc.stop(ctx.currentTime+0.15);
    }
    beep(); setTimeout(beep,200);
}
function backToMenu(){document.getElementById('menu').style.display='block';document.getElementById('workout').style.display='none';checkGymDate();}
function resetProgress(){
    if(confirm("X√≥a to√†n b·ªô ti·∫øn tr√¨nh ƒë√£ l∆∞u (bao g·ªìm c·∫£ ng√†y ƒë√≥ng ti·ªÅn gym v√† b√†i t·∫≠p)?")){
        localStorage.clear();
        // Reset data v·ªÅ m·∫∑c ƒë·ªãnh
        data = {
            chestA: ["Incline Smith Bench Press ‚Äì 4 sets √ó 6-10 reps","Iso-Lateral Chest Press (Incline Angle) ‚Äì 3 sets √ó 10-12 reps","Flat Bench Press Machine ‚Äì 3 sets √ó 10-12 reps","Cable Crossover (High to Low) ‚Äì 3 sets √ó 12-15 reps","Fly Chest Machine ‚Äì 3 sets √ó 12-15 reps"],
            backA: ["Pull-up ‚Äì 4 sets √ó max","Lat Pulldown Machine (wide grip) ‚Äì 3 sets √ó 10-12 reps","Iso-Lateral Pulldown ‚Äì 3 sets √ó 8-10 reps","Seated Cable Row Machine (neutral grip) ‚Äì 3 sets √ó 10-12 reps","Cable Straight Arm Pulldown ‚Äì 3 sets √ó 12-15 reps"],
            shoulder: ["Shoulder Press Smith Machine ‚Äì 4 sets √ó 6-10 reps","Shoulder Press Machine ‚Äì 3 sets √ó 10-12 reps","Dumbbell Lateral Raise ‚Äì 3 sets √ó 12-15 reps","Rear Delt on Fly Machine ‚Äì 3 sets √ó 12-15 reps","Dumbbell Shrugs ‚Äì 3 sets √ó 12-15 reps"],
            backB: ["Pull-up (n·∫Øm ng·ª≠a) ‚Äì 3 sets √ó max","Iso-Lateral Row ‚Äì 3 sets √ó 8-10 reps","Seated Cable Row (wide grip ho·∫∑c V-bar) ‚Äì 3 sets √ó 10-12 reps","Cable Shrug ‚Äì 3 sets √ó 15 reps"],
            chestB: ["Flat Barbell Bench Press ‚Äì 4 sets √ó 6-10 reps","Flat Bench Press Machine ‚Äì 3 sets √ó 10-12 reps","Iso-Lateral Chest Press (neutral/flat) ‚Äì 3 sets √ó 10-12 reps","Cable Crossover (Low to High) ‚Äì 3 sets √ó 12-15 reps","Fly Chest Machine ‚Äì 3 sets √ó 12-15 reps"],
            backC: ["Pull-up (r·ªông) ‚Äì 3 sets √ó max","Lat Pulldown Machine (reverse grip) ‚Äì 3 sets √ó 10 reps","Iso-Lateral Pulldown (t·ª´ng tay) ‚Äì 3 sets √ó 8 reps m·ªói b√™n","Seated Cable Row (drop set) ‚Äì 3 sets (10-10-10 reps, gi·∫£m t·∫°)","Dumbbell Shrug ho·∫∑c Cable Shrug ‚Äì 3 sets √ó 15 reps"]
        };
        saveWorkoutData();
        alert("ƒê√£ x√≥a to√†n b·ªô ti·∫øn tr√¨nh!");
        checkGymDate();
    }
}

checkGymDate();
</script>
</body>
</html>